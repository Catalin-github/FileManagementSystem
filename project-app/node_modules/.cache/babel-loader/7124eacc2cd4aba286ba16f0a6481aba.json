{"ast":null,"code":"import { LOGIN_REQUEST, LOGIN_SUCCES, LOGIN_ERROR, EDIT_PROFILE, REGISTER_SUCCESS } from \"./actionType\";\nimport axios from \"axios\";\nimport { Redirect } from \"react-router-dom\";\nimport React, { Component } from 'react';\nimport Dashboard from \"../../components/Dashboard\"; //import { useHistory } from \"react-router-dom\";\n// const history = useHistory();\n\nexport const fetchUsersLogin = (email, password) => {\n  return dispatch => {\n    console.log(email);\n    console.log(password);\n    axios({\n      method: 'POST',\n      url: '/dia-aplication/api/user/login',\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      data: {\n        email: email,\n        password: password\n      },\n      credentials: \"include\"\n    }).then(res => {\n      console.log(res);\n      console.log(\"sadsdsadadadasdasdas\");\n\n      if (res.success === false) {\n        throw new Error('Email or password incorect!');\n      }\n\n      console.log(\"you are in login\");\n      console.log(res.data);\n      console.log(res.data.dataUserResponse);\n      dispatch(loginSuccess({\n        data: res.data.dataUserResponse,\n        success: res.data.success,\n        message: res.data.message\n      }));\n    }).catch(err => {\n      console.log(err);\n      dispatch(loginError(\"Login Failed, Please Try Again\"));\n    });\n  };\n};\nexport const fetchUsersRegister = data => {\n  return dispatch => {\n    fetch(`/dia-aplication/api/user/register`, {\n      method: \"POST\",\n      body: JSON.stringify(data),\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      credentials: \"include\"\n    }).then(res => res.json()) ///////////\n    .then(res => {\n      console.log(res);\n      console.log(res.dataUserResponse);\n      console.log(res.dataUserResponse.firstName);\n\n      if (res.success === false) {\n        throw new Error('Your data is invalid!');\n      }\n\n      dispatch(registerSuccess({\n        data: res.dataUserResponse,\n        message: res.message,\n        succes: res.success\n      })); //    history.push(\"/\");\n      // return( <Redirect exact to=\"/dashboard\"/>)    \n\n      console.log(\"true\");\n      return true;\n    }).catch(err => {\n      dispatch(loginError(err));\n      console.error(err.value);\n    });\n  };\n};\nexport const verifyAuthentication = verifyToken => {\n  return dispatch => {\n    fetch(`/dia-aplication/api/user/isAuthenticated`, {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      credentials: \"include\"\n    }).then(res => res.json()) /////////////\n    .then(res => {\n      console.log(res);\n\n      if (!res.success) {\n        throw new Error('You are not authenticated!');\n      }\n\n      if (res.success) {\n        dispatch(loginSuccess({\n          data: res.dataUserResponse\n        }));\n      }\n\n      if (window.location.pathname === \"/account\") {\n        dispatch(loginRequest());\n      }\n    }).catch(err => {\n      console.log(err);\n      dispatch(loginError(err));\n    });\n  };\n};\nexport const verifyRefreshToken = () => {\n  return dispatch => {\n    fetch(`/dia-aplication/api/user/isAuthenticated`, {\n      mothod: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      credentials: \"include\"\n    }).then(res => res.json()).then(res => {\n      const user = {\n        data: res.dataUserResponse\n      };\n\n      if (res.verifyToken) {\n        dispatch(loginSuccess(user));\n      }\n    }).catch(err => {\n      dispatch(loginError(err));\n    });\n  };\n};\nexport const logoutUser = () => {\n  return dispatch => {\n    fetch(\"http://localhost:5000/logout\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      credentials: \"include\"\n    }).then(res => {\n      console.log(\"here\");\n\n      if (res.status == 200) {\n        dispatch(loginError());\n      }\n    }).catch(err => {\n      dispatch(loginError(err));\n    });\n  };\n};\nexport const fetchUsersEditProfile = (data, verifyToken) => {\n  return dispatch => {\n    fetch(`http://localhost:5000/MyAccount`, {\n      method: \"POST\",\n      body: JSON.stringify(data),\n      headers: {\n        \"Content-Type\": \"application/json\",\n        authorization: `Baerer ${verifyToken}`\n      },\n      credentials: \"include\"\n    }).then(res => res.json()).then(res => {\n      if (res.isAuthenticated) {}\n\n      dispatch(loginSuccess({\n        data: res.user\n      }));\n      dispatch(editProfile());\n    }).catch(err => {\n      dispatch(loginError(err));\n    });\n  };\n};\nexport const changePassword = data => {\n  return dispatch => {\n    fetch(`http://localhost:5000/ChangePassword`, {\n      method: \"POST\",\n      body: JSON.stringify(data),\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      credentials: \"include\"\n    }).then(res => res.json()).then(res => {\n      dispatch(loginError());\n    }).catch(err => {\n      dispatch(loginError(err));\n    });\n  };\n};\nexport const fetchLoginGoogle = res => {\n  return dispatch => {\n    axios({\n      url: '/dia-aplication/api/user/google',\n      headers: {\n        \"Access-Control-Allow-Origin\": \"http://localhost:3000\",\n        'Access-Control-Allow-Credentials': true,\n        'Access-Control-Allow-Methods': 'GET,PUT,POST,DELETE,PATCH,OPTIONS',\n        \"Vary\": \"Origin\",\n        \"Origin\": \"http://localhost:3000\",\n        \"Content-Type\": \"application/json\"\n      },\n      data: {\n        token: res.tokenId\n      }\n    }).then(res => {\n      console.log(res);\n      console.log(\"you are in login2222222222222222222222222222222222222222222222222222222222222222222222\");\n      console.log(res.data);\n      console.log(res.data.user);\n      console.log(res.data.dataUserResponse); // dispatch(loginSuccess({ data: res.data.dataUserResponse, success: res.dta.success, message:res.data.message }));\n    }).catch(err => {\n      console.log(err + \"you are here\");\n      console.log(\"dssssssssssssssssssssssssssssssssssyou are here\");\n      dispatch(loginError(\"Login Failed, Please Try Again\"));\n    });\n  };\n};\nexport const fetchLoginFacebook = tokenId => {\n  return dispatch => {\n    fetch(\"/login/api/user/auth/facebook\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": `application/json`\n      },\n      body: JSON.stringify(tokenId),\n      credentials: \"include\"\n    }).then(res => {\n      return res.json();\n    }).then(res => {\n      if (res.success === false || res.message === \"\") {\n        throw new Error('Email or password incorect!');\n      }\n\n      dispatch(loginSuccess({\n        data: res.user,\n        success: res.success,\n        message: res.message\n      }));\n    }).catch(err => {\n      console.log(err);\n      dispatch(loginError(\"Login Failed, Please Try Again\"));\n    });\n  };\n};\nexport const AccountRequest = email => {\n  return dispatch => {\n    fetch(`/api/user/account?email=${email}`, {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      credentials: \"include\"\n    }).then(res => {\n      if (res.status > 399) {\n        throw new Error('my error');\n      }\n\n      return res.json();\n    }).then(res => {\n      dispatch(loginSuccess({\n        data: res\n      }));\n    }).catch(err => {\n      console.log(err.message);\n      dispatch(loginError(err));\n    });\n  };\n};\nexport const fetchUserDeleteAccount = verifyToken => {\n  return dispatch => {\n    fetch(`http://localhost:5000/MyAccount`, {\n      method: \"DELETE\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        authorization: `Baerer ${verifyToken}`\n      },\n      credentials: \"include\"\n    }).then(res => {\n      dispatch(editProfile());\n      dispatch(loginError());\n    }).catch(err => {\n      dispatch(loginError(err));\n    });\n  };\n};\nexport const loginRequest = () => {\n  return {\n    type: LOGIN_REQUEST\n  };\n};\nexport const loginSuccess = res => {\n  return {\n    type: LOGIN_SUCCES,\n    payload: res\n  };\n};\nexport const loginError = err => {\n  return {\n    type: LOGIN_ERROR,\n    payload: err\n  };\n};\nexport const editProfile = () => {\n  return {\n    type: EDIT_PROFILE\n  };\n};\nexport const registerSuccess = res => {\n  return {\n    type: REGISTER_SUCCESS,\n    payload: res\n  };\n}; // export const resetValidation=()=>{\n//   return{\n//     type:RESET_VALIDATION\n//   }\n// }\n// export const fetchUsersData = (data) => {\n//   return (dispatch) => {\n//     dispatch(loginRequest());\n//     fetch(\"http://localhost:5000/MyAccount\", {\n//       method: \"POST\",\n//       headers: {\n//         \"Content-Type\": \"application/json\",\n//       },\n//     })\n//       .then((res) => {\n//         dispatch(loginSuccess(data));\n//       })\n//       .catch((err) => {\n//         dispatch(loginError());\n//       });\n//   };\n// };\n// export const fetchUsersRegister_GET = (data) => {\n//   return (dispatch) => {\n//     fetch(`http://localhost:5000/register`, {\n//       method: \"GET\",\n//       body: JSON.stringify(),\n//       headers: { \"Content-Type\": \"application/json\" },\n//       credentials: \"include\",\n//     })\n//       .then((res) => {\n//         if (res.status === 200) {\n//           dispatch(loginSuccess(data));\n//         } else {\n//           console.log(res);\n//           const error = new Error(res);\n//           throw error;\n//         }\n//       })\n//       .catch((err) => {\n//         dispatch(loginError(err));\n//       });\n//   };\n// };","map":{"version":3,"sources":["C:/Users/Samuel M/React/Project/project-app/src/redux/Authentication/action.js"],"names":["LOGIN_REQUEST","LOGIN_SUCCES","LOGIN_ERROR","EDIT_PROFILE","REGISTER_SUCCESS","axios","Redirect","React","Component","Dashboard","fetchUsersLogin","email","password","dispatch","console","log","method","url","headers","data","credentials","then","res","success","Error","dataUserResponse","loginSuccess","message","catch","err","loginError","fetchUsersRegister","fetch","body","JSON","stringify","json","firstName","registerSuccess","succes","error","value","verifyAuthentication","verifyToken","window","location","pathname","loginRequest","verifyRefreshToken","mothod","user","logoutUser","status","fetchUsersEditProfile","authorization","isAuthenticated","editProfile","changePassword","fetchLoginGoogle","token","tokenId","fetchLoginFacebook","AccountRequest","fetchUserDeleteAccount","type","payload"],"mappings":"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","sourcesContent":["import {\r\n  LOGIN_REQUEST,\r\n  LOGIN_SUCCES,\r\n  LOGIN_ERROR,\r\n  EDIT_PROFILE,\r\n  REGISTER_SUCCESS\r\n} from \"./actionType\";\r\nimport axios from \"axios\"\r\nimport { Redirect } from \"react-router-dom\";\r\nimport React, { Component }  from 'react';\r\nimport Dashboard from \"../../components/Dashboard\";\r\n//import { useHistory } from \"react-router-dom\";\r\n// const history = useHistory();\r\n\r\n\r\nexport const fetchUsersLogin = (email,password) => {\r\n  return (dispatch) => {\r\n    console.log(email)\r\n    console.log(password)\r\n    axios({\r\n      method: 'POST',\r\n      url: '/dia-aplication/api/user/login',\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n\r\n      data: {\r\n        email: email,\r\n        password: password\r\n      },\r\n      credentials:\"include\"\r\n    }) \r\n      .then((res) => {\r\n        console.log(res)\r\n        console.log(\"sadsdsadadadasdasdas\")\r\n        if(res.success === false){ \r\n          throw new Error('Email or password incorect!');\r\n        }       \r\n        console.log(\"you are in login\")\r\n        console.log(res.data)\r\n         console.log(res.data.dataUserResponse)\r\n\r\n        dispatch(loginSuccess({ data: res.data.dataUserResponse, success: res.data.success, message:res.data.message }));\r\n      })\r\n      .catch((err) => {\r\n        console.log(err)\r\n        dispatch(loginError(\"Login Failed, Please Try Again\"));\r\n      });\r\n  };\r\n}\r\n\r\nexport const fetchUsersRegister =   (data) => {\r\n  return  (dispatch) => {\r\n\r\n      fetch(`/dia-aplication/api/user/register`, {\r\n      method: \"POST\",\r\n      body: JSON.stringify(data),\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      credentials: \"include\",\r\n    })\r\n       .then((res) => res.json())///////////\r\n      .then((res) => {\r\n console.log(res)\r\n console.log(res.dataUserResponse)\r\n console.log(res.dataUserResponse.firstName)\r\n\r\n if(res.success === false){ \r\n          throw new Error('Your data is invalid!');\r\n        }      \r\n        dispatch(registerSuccess({ data: res.dataUserResponse, message: res.message, succes:res.success}));\r\n  //    history.push(\"/\");\r\n           // return( <Redirect exact to=\"/dashboard\"/>)    \r\n           console.log(\"true\")\r\n     return true\r\n    })\r\n\r\n      .catch((err) => {\r\n        dispatch(loginError(err));\r\n        console.error(err.value);\r\n      });\r\n  };\r\n};\r\n\r\n\r\nexport const verifyAuthentication = (verifyToken) => {\r\n  return (dispatch) => {\r\n  \r\n    fetch(`/dia-aplication/api/user/isAuthenticated`, {\r\n      method: \"GET\",\r\n      headers: {  \"Content-Type\": \"application/json\",   },\r\n      credentials: \"include\",\r\n    })\r\n      .then((res) => res.json())/////////////\r\n      .then((res) => {\r\n        console.log(res)\r\n        if (!res.success) {\r\n          throw new Error('You are not authenticated!');\r\n        }\r\n\r\n        if (res.success) {\r\n          dispatch(loginSuccess({ data: res.dataUserResponse}));\r\n        }\r\n        if(window.location.pathname === \"/account\"){\r\n          dispatch(loginRequest() )\r\n        }\r\n      })\r\n\r\n      .catch((err) => {       \r\n        console.log(err)\r\n        dispatch(loginError(err));\r\n      });\r\n  };\r\n};\r\n\r\nexport const verifyRefreshToken = () => {\r\n  return (dispatch) => {\r\n    fetch(`/dia-aplication/api/user/isAuthenticated`, {\r\n      mothod: \"GET\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      credentials: \"include\",\r\n    })\r\n      .then((res) => res.json())\r\n      .then((res) => {\r\n   \r\n        const user = { data: res.dataUserResponse  };\r\n\r\n        if (res.verifyToken) {\r\n          dispatch(loginSuccess(user));\r\n        }\r\n      })\r\n      .catch((err) => {\r\n        dispatch(loginError(err));\r\n      });\r\n  };\r\n};\r\n\r\nexport const logoutUser = () => {\r\n  return (dispatch) => {\r\n    fetch(\"http://localhost:5000/logout\", {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      credentials: \"include\",\r\n    })\r\n      .then((res) => {\r\n        console.log(\"here\");\r\n        if (res.status == 200) {\r\n          dispatch(loginError());\r\n        }\r\n      })\r\n      .catch((err) => {\r\n        dispatch(loginError(err));\r\n      });\r\n  };\r\n};\r\n\r\nexport const fetchUsersEditProfile = (data, verifyToken) => {\r\n\r\n  return (dispatch) => {\r\n\r\n    fetch(`http://localhost:5000/MyAccount`, {\r\n      method: \"POST\",\r\n      body: JSON.stringify(data),\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        authorization: `Baerer ${verifyToken}`,\r\n      },\r\n      credentials: \"include\",\r\n    })\r\n      .then((res) => res.json())\r\n      .then((res) => {\r\n        if(res.isAuthenticated){}\r\n        dispatch(loginSuccess({ data: res.user }));\r\n\r\n   \r\n        dispatch(editProfile());\r\n      })\r\n      .catch((err) => {\r\n\r\n        dispatch(loginError(err));\r\n      });\r\n  };\r\n};\r\n\r\nexport const changePassword = (data) => {\r\n  return (dispatch) => {\r\n    fetch(`http://localhost:5000/ChangePassword`, {\r\n      method: \"POST\",\r\n      body: JSON.stringify(data),\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      credentials: \"include\",\r\n    })\r\n      .then((res) => res.json())\r\n      .then((res) => {\r\n        dispatch(loginError());\r\n      })\r\n      .catch((err) => {\r\n        dispatch(loginError(err));\r\n      });\r\n  };\r\n};\r\n\r\nexport const fetchLoginGoogle = (res) => {\r\n  return (dispatch) => {\r\n    axios({\r\n       url: '/dia-aplication/api/user/google',\r\n      headers: {\"Access-Control-Allow-Origin\": \"http://localhost:3000\",'Access-Control-Allow-Credentials':true,'Access-Control-Allow-Methods':'GET,PUT,POST,DELETE,PATCH,OPTIONS',\"Vary\": \"Origin\",\"Origin\":\"http://localhost:3000\", \"Content-Type\": \"application/json\"},\r\n      data: {  token: res.tokenId, } \r\n    }) \r\n      .then((res) => {\r\n        console.log(res)      \r\n        console.log(\"you are in login2222222222222222222222222222222222222222222222222222222222222222222222\")\r\n        console.log(res.data)\r\n        console.log(res.data.user)\r\n        console.log(res.data.dataUserResponse)\r\n  // dispatch(loginSuccess({ data: res.data.dataUserResponse, success: res.dta.success, message:res.data.message }));\r\n      })\r\n      .catch((err) => {\r\n        console.log(err+ \"you are here\")\r\n        console.log(\"dssssssssssssssssssssssssssssssssssyou are here\")\r\n        dispatch(loginError(\"Login Failed, Please Try Again\"));\r\n      });\r\n  };\r\n};\r\n\r\nexport const fetchLoginFacebook = (tokenId) => {\r\n  return (dispatch) => {  \r\n    fetch(\"/login/api/user/auth/facebook\", {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": `application/json` },\r\n      body: JSON.stringify(tokenId),\r\n      credentials: \"include\",\r\n    })\r\n      .then((res) =>{   \r\n      return res.json()\r\n      })\r\n      .then((res) => {\r\n        if(res.success === false || res.message === \"\"){ \r\n          throw new Error('Email or password incorect!');\r\n        }\r\n        dispatch(loginSuccess({ data: res.user, success: res.success, message:res.message }))\r\n             \r\n       })\r\n      .catch((err) => {\r\n        console.log(err)\r\n        dispatch(loginError(\"Login Failed, Please Try Again\"));\r\n      });\r\n  };\r\n};\r\n\r\n\r\n\r\nexport const AccountRequest = (email) => {\r\n  return (dispatch) => {\r\n      fetch(`/api/user/account?email=${email}`, {\r\n      method: \"GET\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      credentials: \"include\",\r\n    })\r\n      .then((res) =>{  \r\n    if(res.status>399){\r\n     throw new Error('my error');\r\n    }\r\n       return res.json()\r\n      })\r\n      .then((res) => {\r\n        dispatch(loginSuccess({ data: res }));\r\n\r\n   \r\n      })\r\n      .catch((err) => {\r\n\r\n      console.log(err.message)\r\n        dispatch(loginError(err));\r\n      });\r\n  };\r\n};\r\n\r\n\r\nexport const fetchUserDeleteAccount = (verifyToken) => {\r\n  return (dispatch) => {\r\n    fetch(`http://localhost:5000/MyAccount`, {\r\n      method: \"DELETE\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        authorization: `Baerer ${verifyToken}`,\r\n      },\r\n      credentials: \"include\",\r\n    })\r\n      .then((res) => {\r\n        dispatch(editProfile());\r\n\r\n        dispatch(loginError());\r\n      })\r\n      .catch((err) => {\r\n        dispatch(loginError(err));\r\n      });\r\n  };\r\n};\r\n\r\nexport const loginRequest = () => {\r\n  return {\r\n    type: LOGIN_REQUEST,\r\n  };\r\n};\r\n\r\nexport const loginSuccess = (res) => {\r\n  return {\r\n    type: LOGIN_SUCCES,\r\n    payload: res,\r\n  };\r\n};\r\n\r\nexport const loginError = (err) => {\r\n  return {\r\n    type: LOGIN_ERROR,\r\n    payload: err,\r\n  };\r\n};\r\n\r\nexport const editProfile = () => {\r\n  return {\r\n    type: EDIT_PROFILE,\r\n  };\r\n};\r\nexport const registerSuccess = (res) => {\r\n  return {\r\n    type: REGISTER_SUCCESS,\r\n    payload: res,\r\n  };\r\n};\r\n\r\n// export const resetValidation=()=>{\r\n//   return{\r\n//     type:RESET_VALIDATION\r\n//   }\r\n// }\r\n\r\n// export const fetchUsersData = (data) => {\r\n//   return (dispatch) => {\r\n//     dispatch(loginRequest());\r\n//     fetch(\"http://localhost:5000/MyAccount\", {\r\n//       method: \"POST\",\r\n//       headers: {\r\n//         \"Content-Type\": \"application/json\",\r\n//       },\r\n//     })\r\n//       .then((res) => {\r\n//         dispatch(loginSuccess(data));\r\n//       })\r\n//       .catch((err) => {\r\n//         dispatch(loginError());\r\n//       });\r\n//   };\r\n// };\r\n\r\n\r\n\r\n// export const fetchUsersRegister_GET = (data) => {\r\n//   return (dispatch) => {\r\n\r\n//     fetch(`http://localhost:5000/register`, {\r\n//       method: \"GET\",\r\n//       body: JSON.stringify(),\r\n//       headers: { \"Content-Type\": \"application/json\" },\r\n//       credentials: \"include\",\r\n//     })\r\n//       .then((res) => {\r\n//         if (res.status === 200) {\r\n//           dispatch(loginSuccess(data));\r\n//         } else {\r\n//           console.log(res);\r\n//           const error = new Error(res);\r\n//           throw error;\r\n//         }\r\n//       })\r\n//       .catch((err) => {\r\n//         dispatch(loginError(err));\r\n//       });\r\n//   };\r\n// };\r\n"]},"metadata":{},"sourceType":"module"}